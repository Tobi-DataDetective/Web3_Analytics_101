-- what are the various nft project available?
SELECT distinct project
FROM nft.trades

-- HOW MUCH GENERATED BY DAY?
select date_trunc('day',block_time) AS "Date",
SUM(amount_usd) AS "Total Volume"
FROM nft.trades
GROUP BY 1
ORDER BY 1 DESC
LIMIT 100


-- HOW MUCH GENERATED BY DAY opensea?
select date_trunc('day',block_time) AS "Date",
SUM(amount_usd) AS "Total Volume"
FROM nft.trades
WHERE project = 'opensea'
GROUP BY 1
ORDER BY 1 DESC
-- SELECT distinct project FROM nft.trades



-- HOW MUCH GENERATED BY DAY sum of amount, number of buyers and number of sellers?
select date_trunc('day',block_time) AS "Date",
SUM(amount_usd) AS "Total Volume",
COUNT(*) AS "Transactions",
COUNT(distinct buyer) AS "Buyers",
COUNT(distinct seller) AS "Sellers"
FROM nft.trades
WHERE project = 'opensea'
GROUP BY 1
ORDER BY 1 DESC
-- SELECT distinct project FROM nft.trades



-- HOW MUCH GENERATED BY DAY sum of amount,on different projects?
select date_trunc('day',block_time) AS "Date",
    (CASE WHEN project = 'opensea' THEN SUM(amount_usd)END)AS "opensea",
    (CASE WHEN project = 'looksrare' THEN SUM(amount_usd)END )AS "looksrare",
    (CASE WHEN project = 'superrare' THEN SUM(amount_usd) END)AS "superrare",
    (CASE WHEN project = 'cryptopunks' THEN SUM(amount_usd)END )AS "cryptopunks",
    (CASE WHEN project = 'rarible' THEN SUM(amount_usd)END )AS "rarible",
    (CASE WHEN project = 'oneplanet' THEN SUM(amount_usd)END )AS "oneplanet"

FROM nft.trades
-- WHERE tx_hash NOT IN ('***********','******************')
GROUP BY 1, project
ORDER BY 1 DESC
-- SELECT distinct project FROM nft.trades



-- HOW MUCH GENERATED BY DAY sum of amount,on different projects?
WITH seperated_volume AS (select date_trunc('day',block_time) AS "Date",
    (CASE WHEN project = 'opensea' THEN SUM(amount_usd)END)AS "opensea",
    (CASE WHEN project = 'looksrare' THEN SUM(amount_usd)END )AS "looksrare",
    (CASE WHEN project = 'superrare' THEN SUM(amount_usd) END)AS "superrare",
    (CASE WHEN project = 'cryptopunks' THEN SUM(amount_usd)END )AS "cryptopunks",
    (CASE WHEN project = 'rarible' THEN SUM(amount_usd)END )AS "rarible",
    (CASE WHEN project = 'oneplanet' THEN SUM(amount_usd)END )AS "oneplanet"

FROM nft.trades
-- WHERE tx_hash NOT IN ('***********','******************')
GROUP BY 1, project)
-- SELECT distinct project FROM nft.trades

SELECT "Date",
SUM("opensea") AS "opensea",
SUM("looksrare") AS "looksrare",
SUM("superrare") AS "superrare",
SUM("cryptopunks") AS "cryptopunks",
SUM("rarible") AS "rarible",
SUM("oneplanet") AS "oneplanet"
FROM seperated_volume
GROUP BY 1


-- starting from the reading date
-- HOW MUCH GENERATED BY DAY sum of amount,on different projects?
WITH seperated_volume AS (
select date_trunc('day',block_time) AS "Date",
    (CASE WHEN project = 'opensea' THEN SUM(amount_usd)END)AS "opensea",
    (CASE WHEN project = 'looksrare' THEN SUM(amount_usd)END )AS "looksrare",
    (CASE WHEN project = 'superrare' THEN SUM(amount_usd) END)AS "superrare",
    (CASE WHEN project = 'cryptopunks' THEN SUM(amount_usd)END )AS "cryptopunks",
    (CASE WHEN project = 'rarible' THEN SUM(amount_usd)END )AS "rarible",
    (CASE WHEN project = 'oneplanet' THEN SUM(amount_usd)END )AS "oneplanet"

FROM nft.trades
WHERE block_time >= (date_trunc('day', NOW())- interval '1' year)
GROUP BY 1, project)
-- SELECT distinct project FROM nft.trades

SELECT "Date",
SUM("opensea") AS "opensea",
SUM("looksrare") AS "looksrare",
SUM("superrare") AS "superrare",
SUM("cryptopunks") AS "cryptopunks",
SUM("rarible") AS "rarible",
SUM("oneplanet") AS "oneplanet"
FROM seperated_volume
GROUP BY 1